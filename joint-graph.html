<!--
    TODO keep a track of the number of nodes excluding cf and on the blocked mobilities when we add a link
-->

<!doctype html>
<html>
<head>
    <title>Graph</title>
    <!--from the web-->
    <script src='js/lib/cytoscape.min.js'></script>
    <script src='js/lib/math.js'></script>
    <script src='js/lib/nerdamer-all.min.js'></script>
    <!--<script src='js/gausselimination.js'></script>-->
    <!-- from this project-->
    <script src='examples/helico.js'></script>
    <script src='js/graph/find_cycles.js'></script>
    <script src='js/graph/computecycles.js'></script>
    <script src='js/graph/export.js'></script>
    <script src='js/graph/component.js'></script>
    <script src='js/graph/mech.js'></script>
    <script src='js/graph/mechmath.js'></script>
    <script src='js/graph/ui.js'></script>
    <script src='js/sidebar.js'></script>
    <script src='translation/translation.js'></script>
    <script src='js/calculator.js'></script>
    <link rel="stylesheet" type="text/css" href="css/cytoscape.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/sidebar.css">
    <meta charset="UTF-8">

</head>
<!--side calculator-->
<iframe src="htmlBricks/sideCalculator.html" id="embed_calculator" width="305" height="340" scrolling="no" frameBorder="0"></iframe>
<input type="button" id="calculator_button" value="" onclick="toggleCalculator()">
<!--discord-->
<a href="https://discord.com/channels/957674596545495101/957674597006843985" target="_blank" id="discord_link"><img src="img/discord.png" alt="discord"></a>

<body>
    <!-- TOPBAR -->
    <iframe id="help" src="htmlBricks/topBar.html?gitRepo=https://github.com/guillaume55/MecaWeb&download=https://guillaume55.github.io/MecaWeb/cuts.html&helpPage=https://copo.app/index.php/graph-liaison/" height="50px" width="100%" frameborder="0"></iframe>

    <!-- SIDEBAR -->
    <div id="mySidebar" class="sidebar">
        <div id="sidebar-btn" onclick="toggleSidebar()">â˜°</div>
        <div id="sidebar-content"></div>
        <script>appendToSidebar("sidebar-content");</script>
    </div>

    <div id="main">
        <div id="cy"></div>
        <div class="tab">
            <button class="tablinks" onclick="openTab(event, 'anode')">{Sub-assemblies}</button>
            <button class="tablinks" onclick="openTab(event, 'alink')">{Links}</button>
            <button class="tablinks" onclick="openTab(event, 'edit')">{Edit}</button>
            <button class="tablinks" onclick="openTab(event, 'export')">{Export}</button>
        </div>

        <div id="alink" class="tabcontent"></div>
        <div id="anode" class="tabcontent"></div>
        <div id="edit" class="tabcontent"></div>
        <div id="export" class="tabcontent"></div>
    </div>
    
    <script>
        var graph = []
        let cycles = []

        //helico 
        let I_to_replace = { 'I_alpha_J2_LA':"0", 'I_alpha_J1_LA':"0", "I_alpha_J3_LA":"0","I_alpha_J4_ROT":"0"} //I stands for unknown. if we find their value, they will be logged here
        //boitier
        //I_to_replace = { 'I_gamma_ARBRE_CARTER_LA1':"0", 'I_gamma_ARBRE_CARTER_LA2':"0", 'I_gamma_SAT_ARBRE_LA':'0','I_gamma_SAT_ARBRE_ROT':'0' } //c'est vrai ce mensonsonge ?
        //boitier
        //let I_to_replace = { 'I_gamma_ARBRE_CARTER_LA1':"0" }
        //translate("joint-graph")

        //we have to wait until the page is fully translated before using cytoscape
        //isues with translation
        async function init_graph() {
            //await translate("joint-graph");
            return new Promise((resolve) => {
                console.log("2nd");
                resolve();
            });
        }

        var cy;
        function create_cytoscape(){
            cy = cy_create(document.getElementById('cy'))
            comp_sLink(document.getElementById('alink'),"sa1 sa2 name")
            comp_sNode(document.getElementById('anode'))
            edit_tab(document.getElementById('edit'), undefined)
            export_button(document.getElementById('export'))

            cy.on('tap', 'node', function(evt){
                var node = evt.target;
                openTab(event, 'edit')
                console.log( 'tapped ' + node.id() );
                edit_tab(document.getElementById('edit'), node.id())
            });
            cy.on('tap', 'edge', function(evt){
                var edge = evt.target;
                openTab(event, 'edit')
                console.log( 'tapped ' + edge.id() );
                edit_tab(document.getElementById('edit'), edge.id())
            });

            
        }

        init_graph();
        init_graph().then(create_cytoscape());
        

        //findCycles()
        //reduce_equations()
        /*cy.pan({
        x: 100,
        y: 100
        });*/

        //console.log([5,0,10],[10,0,0], ["a","b","c"], ["u","v","w"]))
        //console.log(mechmath_babar([20,30,10],[10,20,0], ["a","b","c"], ["u","v","w"]))
        //findCycles()
        //write_eq_V2(/*edge*/)
    </script>
</body>
</html>
